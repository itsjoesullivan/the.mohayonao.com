(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Ciseaux=e()}})(function(){var e,t,r;return function n(e,t,r){function a(u,o){if(!t[u]){if(!e[u]){var s=typeof require=="function"&&require;if(!o&&s)return s(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var c=t[u]={exports:{}};e[u][0].call(c.exports,function(t){var r=e[u][1][t];return a(r?r:t)},c,c.exports,n,e,t,r)}return t[u].exports}var i=typeof require=="function"&&require;for(var u=0;u<r.length;u++)a(r[u]);return a}({1:[function(e,t,r){e("./lib/web-audio-tape").use();t.exports=e("./lib")},{"./lib":4,"./lib/web-audio-tape":11}],2:[function(e,t,r){"use strict";t.exports={sampleRate:0,from:null,create:null,render:null}},{}],3:[function(e,t,r){"use strict";var n=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var a=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var i=r.Fragment=function(){function e(t,r,n){a(this,e);this.data=t;this.beginTime=r;this.endTime=n;this.gain=1;this.pan=0;this.reverse=false;this.pitch=1;this.stretch=false}n(e,null,{duration:{get:function(){return(this.endTime-this.beginTime)/this.pitch},configurable:true},slice:{value:function t(e,r){e=this.beginTime+e*this.pitch;var n=e+r*this.pitch;e=Math.max(this.beginTime,e);n=Math.max(e,Math.min(n,this.endTime));return this.clone({beginTime:e,endTime:n})},writable:true,configurable:true},clone:{value:function r(t){var r=new e(this.data,this.beginTime,this.endTime);r.gain=this.gain;r.pan=this.pan;r.reverse=this.reverse;r.pitch=this.pitch;r.stretch=this.stretch;if(t){Object.keys(t).forEach(function(e){r[e]=t[e]})}return r},writable:true,configurable:true},toJSON:{value:function i(){return{data:this.data,beginTime:this.beginTime,endTime:this.endTime,gain:this.gain,pan:this.pan,reverse:this.reverse,pitch:this.pitch,stretch:this.stretch}},writable:true,configurable:true}});return e}();r["default"]=i;Object.defineProperty(r,"__esModule",{value:true})},{}],4:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=n(e("./sequence"));var i=n(e("./tape"));var u=i.from;var o=i.silence;var s=i.concat;var f=i.mix;t.exports={Sequence:a,Tape:i,from:u,silence:o,concat:s,mix:f}},{"./sequence":8,"./tape":9}],5:[function(e,t,r){(function(e){"use strict";var t=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var n=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var a=!!(e===e.window&&e.URL&&e.Blob&&e.Worker);var i=r.InlineWorker=function(){function r(t,self){var i=this;n(this,r);if(a){var u=t.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1];var o=e.URL.createObjectURL(new e.Blob([u],{type:"text/javascript"}));return new e.Worker(o)}this.self=self;this.self.postMessage=function(e){setTimeout(function(){i.onmessage({data:e})},0)};setTimeout(function(){t.call(self)},0)}t(r,null,{postMessage:{value:function i(e){var t=this;setTimeout(function(){t.self.onmessage({data:e})},0)},writable:true,configurable:true}});return r}();r["default"]=i;Object.defineProperty(r,"__esModule",{value:true})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],6:[function(e,t,r){"use strict";var self={};function n(){self.repository=[];self.onmessage=function(e){switch(e.data.type){case"transfer":self.repository[e.data.data]=e.data.buffers.map(function(e){return new Float32Array(e)});break;case"dispose":delete self.repository[e.data.data];break;case"render":self.startRendering(e.data.tape,e.data.callbackId);break}};self.startRendering=function(e,t){var r=self.allocData(e);var n=r.map(function(e){return e.buffer});self.render(e,r);self.postMessage({callbackId:t,buffers:n},n)};self.allocData=function(e){var t=new Array(e.numberOfChannels);var r=Math.floor(e.duration*e.sampleRate);for(var n=0;n<t.length;n++){t[n]=new Float32Array(r)}return t};self.render=function(e,t){for(var r=0;r<e.tracks.length;r++){self.renderTrack(r,e.tracks[r],t,e.sampleRate)}};self.renderTrack=function(e,t,r,n){var a=t.some(function(e){return e.pan!==0});var i=0;for(var u=0,o=t.length;u<o;u++){var s=t[u];var f=self.repository[s.data];var c=(s.endTime-s.beginTime)/s.pitch;var l=Math.floor(c*n);if(!f){i+=l;continue}var h=Math.floor(s.beginTime*n);var m=Math.floor(s.endTime*n);var p=f.length;var v=r.length;var d=self.subarray(f,h,m);var g=self.subarray(r,i,i+l);var b=s.pitch;var w=e===0&&b===1&&!a&&s.gain===1&&!s.reverse&&p<=v&&d[0].length===g[0].length;if(w){self.mix[d.length+"->"+g.length](d,g)}else{self.process(d,g,{gain:s.gain,pan:a?Math.max(-1,Math.min(s.pan,+1)):null,reverse:!!s.reverse})}i+=l}};self.subarray=function(e,t,r){var n=new Array(e.length);for(var a=0;a<n.length;a++){n[a]=e[a].subarray(t,r)}return n};self.process=function(e,t,r){var n=new Array(e.length);var a=e.length;var i=t.length;var u;var o=e[0].length;var s=t[0].length;var f=(o-1)/(s-1);var c,l,h,m,p,v;if(r.pan!==null){p=Math.cos((r.pan+1)*.25*Math.PI);v=Math.sin((r.pan+1)*.25*Math.PI);u=Math.max(a,2)}else{u=a}m=self.mix1[u+"->"+i]||self.mix1.nop;if(r.reverse){c=t[0].length-1;l=-1}else{c=0;l=+1}for(var d=0;d<s;d++,c+=l){var g=d*f;var b=g|0;var w=Math.min(b+1,o-1);for(h=0;h<a;h++){n[h]=e[h][b]+Math.abs(g-b)*(e[h][w]-e[h][b])}if(r.pan!==null){n=self.pan[a](n,p,v)}var y=m(n);for(h=0;h<i;h++){t[h][c]+=(y[h]||0)*r.gain}}};self.pan=[];self.pan[1]=function(e,t,r){return[e[0]*t,e[0]*r]};self.pan[2]=function(e,t,r){var n=(e[0]+e[1])*.5;return[n*t,n*r]};self.pan[4]=function(e,t,r){var n=(e[0]+e[1])*.5;var a=(e[2]+e[3])*.5;return[n*t,n*r,a*t,a*r]};self.pan[6]=function(e,t,r){var n=(e[0]+e[1])*.5;var a=(e[4]+e[5])*.5;return[n*t,n*r,e[2],e[3],a*t,a*r]};self.mix={};self.mix["1->1"]=function(e,t){t[0].set(e[0])};self.mix["1->2"]=function(e,t){t[0].set(e[0]);t[1].set(e[0])};self.mix["1->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[0])};self.mix["1->6"]=function(e,t){t[2].set(e[0])};self.mix["2->2"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["2->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["2->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["4->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[2].set(e[2]);t[3].set(e[3])};self.mix["4->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[4].set(e[2]);t[5].set(e[3])};self.mix["6->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[2].set(e[2]);t[3].set(e[3]);t[4].set(e[4]);t[5].set(e[5])};self.mix1={};self.mix1.nop=function(e){return e};self.mix1["1->2"]=function(e){return[e[0],e[0]]};self.mix1["1->4"]=function(e){return[e[0],e[0],0,0]};self.mix1["1->6"]=function(e){return[0,0,e[0],0,0,0]};self.mix1["2->4"]=function(e){return[e[0],e[1],0,0]};self.mix1["2->6"]=function(e){return[e[0],e[1],0,0,0,0]};self.mix1["4->6"]=function(e){return[e[0],e[1],0,0,e[2],e[3]]};self.mix1["2->1"]=function(e){return[.5*(e[0]+e[1])]};self.mix1["4->1"]=function(e){return[.25*(e[0]+e[1]+e[2]+e[3])]};self.mix1["6->1"]=function(e){return[.7071*(e[0]+e[1])+e[2]+.5*(e[4]+e[5])]};self.mix1["4->2"]=function(e){return[.5*(e[0]+e[2]),.5*(e[1]+e[3])]};self.mix1["6->2"]=function(e){return[e[0]+.7071*(e[2]+e[4]),e[1]+.7071*(e[2]+e[5])]};self.mix1["6->4"]=function(e){return[e[0]+.7071*e[2],e[1]+.7071*e[2],e[4],e[5]]}}n.self=n.util=self;t.exports=n},{}],7:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=n(e("./inline-worker"));var i=n(e("./render-worker"));var u=new a(i,i.self);var o=[];var s=1;u.onmessage=function(e){var t=e.data.buffers.map(function(e){return new Float32Array(e)});o[e.data.callbackId](t);o[e.data.callbackId]=null};var f=r.renderer={transfer:function(e){var t=s++;var r=e.map(function(e){return e.buffer});u.postMessage({type:"transfer",data:t,buffers:r},r);return t},dispose:function(e){u.postMessage({type:"dispose",data:e})},render:function(e){var t=o.length;u.postMessage({type:"render",tape:e,callbackId:t});return new Promise(function(e){o[t]=e})},util:i.util};r["default"]=f;Object.defineProperty(r,"__esModule",{value:true})},{"./inline-worker":5,"./render-worker":6}],8:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var u=e("./tape");var o=u.Tape;var s=u.TapeConstructor;var f=n(e("./config"));var c=function(e,t){var r=Object.keys(e);for(var n=0;n<r.length;n++){var a=/^\/(.+)?\/(\w*)$/.exec(r[n]);if(a&&new RegExp(a[1],a[2]).test(t)){return e[r[n]]}}return null};var l=function(e,t,r,n){var a=null;if(e.hasOwnProperty(t)){a=e[t]}else{a=c(e,t)}if(typeof a==="function"){a=a(t,r,n)}return a instanceof o?a:null};var h=r.Sequence=function(){function e(){var t=this;for(var r=arguments.length,n=Array(r),a=0;a<r;a++){n[a]=arguments[a]}i(this,e);this.pattern=this.instruments=this.durationPerStep=null;n.forEach(function(e){if(typeof e==="string"){t.pattern=e}else if(typeof e==="number"||Array.isArray(e)){t.durationPerStep=e}else if(typeof e==="object"){t.instruments=e}})}a(e,null,{apply:{value:function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}var n=this;var a=n.pattern;var i=n.instruments;var u=n.durationPerStep;t.forEach(function(e){if(typeof e==="string"){a=e}else if(typeof e==="number"||Array.isArray(e)){u=e}else if(typeof e==="object"){i=e}});if(a===null||i===null||u===null){return o.silence(0)}var c=Array.isArray(u)?u:[u];return a.split("").reduce(function(e,t,r){var n=l(i,t,r,e);var a=c[r%c.length];a=Math.max(0,+a||0);if(n!==null){if(n.duration<a){e=e.concat(n,o.silence(a-n.duration))}else{e=e.concat(n.slice(0,a))}}else{e=e.concat(o.silence(a))}return e},new s(1,f.sampleRate))},writable:true,configurable:true}});return e}();r["default"]=h;Object.defineProperty(r,"__esModule",{value:true})},{"./config":2,"./tape":9}],9:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var i=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var u=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var o=n(e("./track"));var s=n(e("./config"));var f={};var c=r.Tape=function(){function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}u(this,e);if(s.create){return s.create.apply(null,r)}return new l(r[0],r[1])}i(e,{from:{value:function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}if(s.from){return s.from.apply(null,t)}return Promise.resolve(new l(t[0],t[1]))},writable:true,configurable:true},silence:{value:function r(e){return new l(1,s.sampleRate).silence(e)},writable:true,configurable:true},concat:{value:function n(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}return e.prototype.concat.apply(new l(1,s.sampleRate),r)},writable:true,configurable:true},mix:{value:function a(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}var a=e.prototype.mix.apply(new l(1,s.sampleRate),r);if(1<a.tracks.length){a.tracks.shift()}return a},writable:true,configurable:true}},{sampleRate:{get:function(){return this._sampleRate||s.sampleRate},configurable:true},length:{get:function(){return Math.floor(this.duration*this.sampleRate)},configurable:true},duration:{get:function(){return this.tracks[0].duration},configurable:true},numberOfChannels:{get:function(){return this._numberOfChannels},configurable:true},numberOfTracks:{get:function(){return this.tracks.length},configurable:true},gain:{value:function(e){var t=function r(){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(){var e=arguments[0]===undefined?1:arguments[0];e=f.toNumber(e);var t=new l(this.numberOfChannels,this.sampleRate);t.tracks=this.tracks.map(function(t){return t.gain(e)});return t}),writable:true,configurable:true},pan:{value:function(e){var t=function r(){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(){var e=arguments[0]===undefined?0:arguments[0];e=f.toNumber(e);var t=new l(this.numberOfChannels,this.sampleRate);t.tracks=this.tracks.map(function(t){return t.pan(e)});return t}),writable:true,configurable:true},reverse:{value:function c(){var e=new l(this.numberOfChannels,this.sampleRate);e.tracks=this.tracks.map(function(e){return e.reverse()});return e},writable:true,configurable:true},pitch:{value:function h(){var e=arguments[0]===undefined?1:arguments[0];e=Math.max(0,f.toNumber(e));var t=new l(this.numberOfChannels,this.sampleRate);t.tracks=this.tracks.map(function(t){return t.pitch(e)});return t},writable:true,configurable:true},stretch:{value:function m(){var e=arguments[0]===undefined?1:arguments[0];e=Math.max(0,f.toNumber(e));var t=new l(this.numberOfChannels,this.sampleRate);t.tracks=this.tracks.map(function(t){return t.stretch(e)});return t},writable:true,configurable:true},clone:{value:function p(){var e=new l(this.numberOfChannels,this.sampleRate);e.tracks=this.tracks.map(function(e){return e.clone()});return e},writable:true,configurable:true},silence:{value:function v(){var e=arguments[0]===undefined?0:arguments[0];e=Math.max(0,f.toNumber(e));var t=new l(this.numberOfChannels,this.sampleRate);if(0<e){t.tracks=this.tracks.map(function(){return o.silence(e)})}return t},writable:true,configurable:true},concat:{value:function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}t=Array.prototype.concat.apply([],t);var n=new l(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.clone()});t.forEach(function(e){if(!(e instanceof l&&0<e.duration)){return}if(n._numberOfChannels<e._numberOfChannels){n._numberOfChannels=e._numberOfChannels}if(n.numberOfTracks<e.numberOfTracks){n=f.adjustNumberOfTracks(n,e.numberOfTracks)}if(e.numberOfTracks<n.numberOfTracks){e=f.adjustNumberOfTracks(e,n.numberOfTracks)}e.tracks.forEach(function(e,t){n.tracks[t].append(e)})});return n},writable:true,configurable:true},slice:{value:function g(){var e=arguments[0]===undefined?0:arguments[0];var t=arguments[1]===undefined?Infinity:arguments[1];e=f.toNumber(e);t=Math.max(0,f.toNumber(t));if(e<0){e+=this.duration}e=Math.max(0,e);var r=new l(this.numberOfChannels,this.sampleRate);r.tracks=this.tracks.map(function(r){return r.slice(e,t)});return r},writable:true,configurable:true},loop:{value:function b(){var e=arguments[0]===undefined?2:arguments[0];e=Math.max(0,e|0);var t=new Array(e);for(var r=0;r<t.length;r++){t[r]=this}return new l(this.numberOfChannels,this.sampleRate).concat(t)},writable:true,configurable:true},fill:{value:function w(){var e=arguments[0]===undefined?this.duration:arguments[0];e=Math.max(0,f.toNumber(e));var t=this.duration;if(t===0){return this.silence(e)}var r=Math.floor(e/t);var n=e%t;return this.loop(r).concat(this.slice(0,n))},writable:true,configurable:true},replace:{value:function y(){var e=arguments[0]===undefined?0:arguments[0];var t=arguments[1]===undefined?0:arguments[1];var r=arguments[2]===undefined?null:arguments[2];e=f.toNumber(e);t=Math.max(0,f.toNumber(t));if(e<0){e+=this.duration}e=Math.max(0,e);if(typeof r==="function"){r=r(this.slice(e,t))}return this.slice(0,e).concat(r,this.slice(e+t))},writable:true,configurable:true},split:{value:function O(){var e=arguments[0]===undefined?2:arguments[0];e=Math.max(0,e|0);var t=new Array(e);var r=this.duration/e;for(var n=0;n<e;n++){t[n]=this.slice(r*n,r)}return t},writable:true,configurable:true},mix:{value:function x(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}t=Array.prototype.concat.apply([],t);var n=undefined;if(typeof t[t.length-1]==="string"){n=t.pop()}var a=new l(this.numberOfChannels,this.sampleRate);a.tracks=this.tracks.map(function(e){return e.clone()});t.forEach(function(e){if(!(e instanceof l&&0<e.duration)){return}if(a._numberOfChannels<e._numberOfChannels){a._numberOfChannels=e._numberOfChannels}if(a.duration<e.duration){a=f.adjustDuration(a,e.duration,n)}if(e.duration<a.duration){e=f.adjustDuration(e,a.duration,n)}a.tracks=a.tracks.concat(e.tracks)});return a},writable:true,configurable:true},render:{value:function k(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}if(s.render){return s.render.apply(null,[this.toJSON()].concat(t))}return new Promise(function(e,t){t(new Error("not implemented"))})},writable:true,configurable:true},dispose:{value:function T(){},writable:true,configurable:true},toJSON:{value:function M(){var e=this.tracks.map(function(e){return e.toJSON()});var t=this.duration;var r=this.sampleRate;var n=this.numberOfChannels;var a=e.some(function(e){return e.some(function(e){return e.pan!==0})});if(a){n=Math.max(2,n)}return{tracks:e,duration:t,sampleRate:r,numberOfChannels:n}},writable:true,configurable:true}});return e}();var l=r.TapeConstructor=function(e){function t(e,r){u(this,t);this.tracks=[new o];this._numberOfChannels=Math.max(1,e|0);this._sampleRate=Math.max(0,r|0)||s.sampleRate}a(t,e);return t}(c);f.toNumber=function(e){return+e||0};f.adjustNumberOfTracks=function(e,t){var r=new l(e.numberOfChannels,e.sampleRate);r.tracks=e.tracks.map(function(e){return e.clone()});var n=t-r.numberOfTracks;var a=r.duration;for(var i=0;i<n;i++){r.tracks.push(o.silence(a))}return r};f.adjustDuration=function(e,t,r){if(e.duration===0){return e.silence(t)}switch(r){case"fill":return e.fill(t);case"pitch":return e.pitch(e.duration/t);case"stretch":return e.stretch(e.duration/t);default:return e.concat(e.silence(t-e.duration))}};r["default"]=c;Object.defineProperty(r,"__esModule",{value:true})},{"./config":2,"./track":10}],10:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var u=n(e("./fragment"));var o=r.Track=function(){function e(){var t=arguments[0]===undefined?[]:arguments[0];var r=arguments[1]===undefined?0:arguments[1];i(this,e);this.fragments=t;if(t.length!==0&&r===0){r=t.reduce(function(e,t){return e+t.duration},0)}this.duration=r}a(e,{silence:{value:function t(r){return new e([new u(0,0,r)],r)},writable:true,configurable:true}},{gain:{value:function(e){var t=function r(t){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(t){return new e(this.fragments.map(function(e){return e.clone({gain:e.gain*t})}),this.duration)}),writable:true,configurable:true},pan:{value:function(e){var t=function r(t){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(t){return new e(this.fragments.map(function(e){return e.clone({pan:e.pan+t})}),this.duration)}),writable:true,configurable:true},reverse:{value:function r(){return new e(this.fragments.map(function(e){return e.clone({reverse:!e.reverse})}).reverse(),this.duration)},writable:true,configurable:true},pitch:{value:function n(t){return new e(this.fragments.map(function(e){return e.clone({pitch:e.pitch*t,stretch:false})}),0)},writable:true,configurable:true},stretch:{value:function o(t){return new e(this.fragments.map(function(e){return e.clone({pitch:e.pitch*t,stretch:true})}),0)},writable:true,configurable:true},clone:{value:function s(){return new e(this.fragments.slice(),this.duration)},writable:true,configurable:true},slice:{value:function f(t,r){var n=new e;var a=Math.max(0,t);var i=r;for(var u=0;0<i&&u<this.fragments.length;u++){if(this.fragments[u].duration<=a){a-=this.fragments[u].duration}else{var o=this.fragments[u].slice(a,i);n.addFragment(o);a=0;i-=o.duration}}return n},writable:true,configurable:true},toJSON:{value:function c(){return this.fragments.map(function(e){return e.toJSON()})},writable:true,configurable:true},addFragment:{value:function l(e){if(e instanceof u&&0<e.duration){this.fragments.push(e);this.duration+=e.duration}return this},writable:true,configurable:true},append:{value:function h(t){var r=this;if(t instanceof e){t.fragments.forEach(function(e){r.addFragment(e)})}return this},writable:true,configurable:true}});return e}();r["default"]=o;Object.defineProperty(r,"__esModule",{value:true})},{"./fragment":3}],11:[function(e,t,r){(function(t){"use strict";var n=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var i=function g(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(n===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return g(a,t,r)}}else if("value"in n&&n.writable){return n.value}else{var i=n.get;if(i===undefined){return undefined}return i.call(r)}};var u=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var o=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var s=e("./tape");var f=s.Tape;var c=s.TapeConstructor;var l=n(e("./fragment"));var h=n(e("./config"));var m=n(e("./renderer"));var p=null;var v=r.WebAudioTape=function(e){function t(e){o(this,t);i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e.numberOfChannels,e.sampleRate);var r=new Array(e.numberOfChannels);for(var n=0;n<r.length;n++){r[n]=e.getChannelData(n)}this._data=m.transfer(r);this.tracks[0].addFragment(new l(this._data,0,e.duration));h.sampleRate=e.sampleRate}u(t,e);a(t,null,{dispose:{value:function r(){m.dispose(this._data)},writable:true,configurable:true}});return t}(c);r["default"]=v;var d=r.use=function(){var e=h.from=function(r){var n=arguments[1]===undefined?p:arguments[1];if(r instanceof f){return Promise.resolve(r.clone())}if(r instanceof t.AudioBuffer){return Promise.resolve(new v(r))}if(p===null){p=n||new t.AudioContext}if(r instanceof ArrayBuffer){return new Promise(function(e,t){p.decodeAudioData(r,function(t){e(t)},t)}).then(e)}if(typeof r==="string"){return new Promise(function(e,n){var a=new t.XMLHttpRequest;a.open("GET",r);a.responseType="arraybuffer";a.onload=function(){if(a.status===200){e(a.response)}else{n(new Error(a.statusText))}};a.onerror=function(){n(new Error(a.statusText))};a.send()}).then(e)}return Promise.reject(new Error("Invalid arguments"))};h.create=function(e){return new v(e)};h.render=function(e,t){var r=arguments[2]===undefined?0:arguments[2];r=Math.max(r,e.numberOfChannels);e.numberOfChannels=r;return m.render(e).then(function(n){var a=Math.floor(e.duration*e.sampleRate);var i=t.createBuffer(r,a,e.sampleRate);if(i.copyToChannel){for(var u=0;u<r;u++){i.copyToChannel(n[u],u)}}else{for(var u=0;u<r;u++){i.getChannelData(u).set(n[u])}}return i})}};Object.defineProperty(r,"__esModule",{value:true})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./config":2,"./fragment":3,"./renderer":7,"./tape":9}]},{},[1])(1)});